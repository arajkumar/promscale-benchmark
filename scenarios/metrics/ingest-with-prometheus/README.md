# Ingest metrics with Prometheus as a proxy

This benchmarking scenario is meant to test the performance of Promscale metrics ingestion when using Prometheus as a metrics source. It deploys a single instance of promethues and a single instance of [avalanche](https://github.com/prometheus-community/avalanche). Prometheus is configured to scrape metrics generated by avalanche.

Prometheus is deployed using kubernetes Custom Resource and it is managed by prometheus-operator shipped with tobs. Avalanche is managed by the avalanche helm chart.

## How to run

To start the load generator execute the following command:

```shell
make
```

This will create a namespace `metrics-ingest-direct` and deploy avalanche to it. Alternativelly, you can put this load generator in a different namespace, for example `bench`, by running:

```shell

```shell
NS="bench" make
```

## Configuration

The load generator can be configured by changing options in `values.yaml`. To apply new options run:

```shell
make upgrade
```
